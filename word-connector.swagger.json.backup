{
  "swagger": "2.0",
  "info": {
    "title": "Word Document MCP Connector",
    "description": "Connecteur personnalisé pour créer et manipuler des documents Word via le serveur MCP. Compatible avec Power Apps et Copilot Studio.",
    "version": "1.0"
  },
  "host": "word-mcp-connector.ashywater-9eb5a210.francecentral.azurecontainerapps.io",
  "basePath": "/api",
  "schemes": [
    "https"
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "paths": {
    "/templates/list": {
      "get": {
        "operationId": "ListAllTemplates",
        "summary": "Lister tous les templates",
        "description": "Récupère la liste de tous les templates Word disponibles",
        "responses": {
          "200": {
            "description": "Succès",
            "schema": {
              "type": "string",
              "description": "Liste des templates disponibles"
            }
          }
        }
      }
    },
    "/documents/list": {
      "get": {
        "operationId": "ListAllDocuments",
        "summary": "Lister tous les documents",
        "description": "Récupère la liste de tous les documents Word en storage",
        "responses": {
          "200": {
            "description": "Succès",
            "schema": {
              "type": "string",
              "description": "Liste des documents disponibles"
            }
          }
        }
      }
    },
    "/template/create": {
      "post": {
        "operationId": "CreateDocumentFromTemplate",
        "summary": "Créer un document depuis un template",
        "description": "Crée un nouveau document Word à partir d'un template avec remplacement des variables",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "template_name": {
                  "type": "string",
                  "description": "Nom du template à utiliser (ex: template-text)",
                  "x-ms-summary": "Nom du template"
                },
                "new_document_name": {
                  "type": "string",
                  "description": "Nom du nouveau document à créer (sans extension)",
                  "x-ms-summary": "Nom du document"
                },
                "commercialName": {
                  "type": "string",
                  "description": "Nom du commercial (placeholder: {{commercialName}})",
                  "x-ms-summary": "Nom commercial"
                },
                "commercialEmail": {
                  "type": "string",
                  "description": "Email du commercial (placeholder: {{commercialEmail}})",
                  "x-ms-summary": "Email commercial"
                },
                "commercialTel": {
                  "type": "string",
                  "description": "Téléphone du commercial (placeholder: {{commercialTel}})",
                  "x-ms-summary": "Téléphone"
                },
                "propalContent": {
                  "type": "string",
                  "description": "Contenu de la proposition (placeholder: {{propalContent}})",
                  "x-ms-summary": "Contenu proposition"
                }
              },
              "required": ["template_name", "new_document_name"]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Succès",
            "schema": {
              "type": "object",
              "properties": {
                "message": {
                  "type": "string",
                  "description": "Message de confirmation"
                },
                "document_url": {
                  "type": "string",
                  "description": "URL du document créé"
                }
              }
            }
          }
        }
      }
    },
    "/document/text/replace": {
      "post": {
        "operationId": "ReplaceTextUniversal",
        "summary": "Remplacer du texte dans un document",
        "description": "Remplace toutes les occurrences d'un texte dans un document Word (paragraphes, tableaux, en-têtes, pieds de page)",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "filename": {
                  "type": "string",
                  "description": "Nom du fichier Word (avec ou sans .docx)",
                  "x-ms-summary": "Nom du fichier"
                },
                "find_text": {
                  "type": "string",
                  "description": "Texte à rechercher",
                  "x-ms-summary": "Texte à chercher"
                },
                "replace_text": {
                  "type": "string",
                  "description": "Texte de remplacement",
                  "x-ms-summary": "Nouveau texte"
                }
              },
              "required": ["filename", "find_text", "replace_text"]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Succès",
            "schema": {
              "type": "string",
              "description": "Résultat du remplacement avec URL du document"
            }
          }
        }
      }
    },
    "/document/paragraph/add": {
      "post": {
        "operationId": "AddParagraph",
        "summary": "Ajouter un paragraphe",
        "description": "Ajoute un paragraphe de texte à un document Word",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "filename": {
                  "type": "string",
                  "description": "Nom du fichier Word",
                  "x-ms-summary": "Nom du fichier"
                },
                "text": {
                  "type": "string",
                  "description": "Texte du paragraphe à ajouter",
                  "x-ms-summary": "Texte"
                },
                "style": {
                  "type": "string",
                  "description": "Style du paragraphe (optionnel, ex: Heading 1, Normal)",
                  "x-ms-summary": "Style"
                }
              },
              "required": ["filename", "text"]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Succès",
            "schema": {
              "type": "string",
              "description": "Confirmation d'ajout"
            }
          }
        }
      }
    },
    "/document/heading/add": {
      "post": {
        "operationId": "AddHeading",
        "summary": "Ajouter un titre",
        "description": "Ajoute un titre (heading) à un document Word",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "filename": {
                  "type": "string",
                  "description": "Nom du fichier Word",
                  "x-ms-summary": "Nom du fichier"
                },
                "text": {
                  "type": "string",
                  "description": "Texte du titre",
                  "x-ms-summary": "Texte du titre"
                },
                "level": {
                  "type": "integer",
                  "description": "Niveau du titre (1-9, défaut: 1)",
                  "x-ms-summary": "Niveau",
                  "default": 1
                }
              },
              "required": ["filename", "text"]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Succès",
            "schema": {
              "type": "string",
              "description": "Confirmation d'ajout"
            }
          }
        }
      }
    },
    "/document/table/add": {
      "post": {
        "operationId": "AddTable",
        "summary": "Ajouter un tableau",
        "description": "Ajoute un tableau à un document Word avec dimensions spécifiées",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "filename": {
                  "type": "string",
                  "description": "Nom du fichier Word",
                  "x-ms-summary": "Nom du fichier"
                },
                "rows": {
                  "type": "integer",
                  "description": "Nombre de lignes",
                  "x-ms-summary": "Nombre de lignes"
                },
                "cols": {
                  "type": "integer",
                  "description": "Nombre de colonnes",
                  "x-ms-summary": "Nombre de colonnes"
                },
                "data": {
                  "type": "string",
                  "description": "Données du tableau au format JSON (tableau 2D optionnel)",
                  "x-ms-summary": "Données (JSON)"
                }
              },
              "required": ["filename", "rows", "cols"]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Succès",
            "schema": {
              "type": "string",
              "description": "Confirmation d'ajout du tableau"
            }
          }
        }
      }
    },
    "/document/text/get": {
      "post": {
        "operationId": "GetDocumentText",
        "summary": "Extraire le texte d'un document",
        "description": "Extrait tout le texte d'un document Word",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "filename": {
                  "type": "string",
                  "description": "Nom du fichier Word",
                  "x-ms-summary": "Nom du fichier"
                }
              },
              "required": ["filename"]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Succès",
            "schema": {
              "type": "string",
              "description": "Texte extrait du document"
            }
          }
        }
      }
    },
    "/document/info/get": {
      "post": {
        "operationId": "GetDocumentInfo",
        "summary": "Obtenir les infos d'un document",
        "description": "Récupère les métadonnées et informations d'un document Word",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "filename": {
                  "type": "string",
                  "description": "Nom du fichier Word",
                  "x-ms-summary": "Nom du fichier"
                }
              },
              "required": ["filename"]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Succès",
            "schema": {
              "type": "string",
              "description": "Informations du document (titre, auteur, nombre de pages, etc.)"
            }
          }
        }
      }
    },
    "/document/create": {
      "post": {
        "operationId": "CreateDocument",
        "summary": "Créer un nouveau document",
        "description": "Crée un nouveau document Word vierge avec métadonnées optionnelles",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "filename": {
                  "type": "string",
                  "description": "Nom du fichier Word à créer",
                  "x-ms-summary": "Nom du fichier"
                },
                "title": {
                  "type": "string",
                  "description": "Titre du document (optionnel)",
                  "x-ms-summary": "Titre"
                },
                "author": {
                  "type": "string",
                  "description": "Auteur du document (optionnel)",
                  "x-ms-summary": "Auteur"
                }
              },
              "required": ["filename"]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Succès",
            "schema": {
              "type": "string",
              "description": "Confirmation de création avec URL"
            }
          }
        }
      }
    }
  },
  "definitions": {},
  "parameters": {},
  "responses": {},
  "securityDefinitions": {
    "api_key": {
      "type": "apiKey",
      "name": "X-API-Key",
      "in": "header"
    }
  },
  "security": [
    {
      "api_key": []
    }
  ],
  "tags": []
}
